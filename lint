#!/bin/bash

set -e

# Check if uv is installed
if ! command -v uv &> /dev/null; then
    echo "Error: uv is not installed. Please install uv first." >&2
    echo "Visit https://docs.astral.sh/uv/getting-started/installation/ for installation instructions." >&2
    exit 1
fi

# Parse command line arguments
while [[ $# -gt 0 ]]; do
    case $1 in
        --help|-h)
            echo "Usage: bash lint [OPTIONS]"
            echo ""
            echo "Options:"
            echo "  --help   Show this help message"
            echo ""
            echo "This script runs Python linting using ruff and pyright."
            exit 0
            ;;
        *)
            echo "Unknown option: $1"
            echo "Use --help for usage information"
            exit 1
            ;;
    esac
done

# Unset VIRTUAL_ENV to avoid warnings about mismatched paths
unset VIRTUAL_ENV

echo "üöÄ Running Python Linting Suite"
echo "================================"

# Python linting
echo ""
echo "üìù PYTHON LINTING"
echo "------------------"
echo "Running ruff check (linting)"
uv run ruff check --fix src/ tests/
echo "Running ruff format (formatting + import sorting)"
uv run ruff format src/ tests/
echo "Running pyright (type checking)"
uv run pyright

echo ""
echo "üéâ All linting completed!"
echo "========================="
